!function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(r){return t[r]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=1)}([function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e(3),o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];class i{constructor(t,r,e,n=1){this.x=t,this.y=r,this.z=e,this.w=n}perspectiveDivide(){const{x:t,y:r,z:e,w:n}=this;return new i(t/n,r/n,e/n)}minus(t){const{x:r,y:e,z:n,w:o}=this;return new i(r-t.x,e-t.y,n-t.z,o)}plus(t){const{x:r,y:e,z:n,w:o}=this;return new i(r+t.x,e+t.y,n+t.z,o)}times(t){const{x:r,y:e,z:n,w:o}=this;return new i(r*t,e*t,n*t,o)}normalize(){const{x:t,y:r,z:e,w:n}=this,o=Math.sqrt(t*t+r*r+e*e);return new i(t/o,r/o,e/o,n)}}r.Vector3D=i;class s{constructor(t=o){this.values=t,this.valueAt=this.valueAt.bind(this)}toFloat32Array(){const t=this.valueAt;return new Float32Array([t(1,1),t(2,1),t(3,1),t(4,1),t(1,2),t(2,2),t(3,2),t(4,2),t(1,3),t(2,3),t(3,3),t(4,3),t(1,4),t(2,4),t(3,4),t(4,4)])}static fromFloat32Array(t){return new s([[t[0],t[4],t[8],t[12]],[t[1],t[5],t[9],t[13]],[t[2],t[6],t[10],t[14]],[t[3],t[7],t[11],t[15]]])}valueAt(t,r){return this.values[t-1][r-1]}translate(t,r,e){return e=t instanceof i?t.z:e||0,r=t instanceof i?t.y:r||0,t=t instanceof i?t.x:t,this.multiply(new s([[1,0,0,t],[0,1,0,r],[0,0,1,e],[0,0,0,1]]))}scale(t){return this.multiply(new s([[t,0,0,0],[0,t,0,0],[0,0,t,0],[0,0,0,1]]))}rotateX(t){const r=Math.cos(t),e=Math.sin(t);return this.multiply(new s([[1,0,0,0],[0,r,e,0],[0,-e,r,0],[0,0,0,1]]))}rotateY(t){const r=Math.cos(t),e=Math.sin(t);return this.multiply(new s([[r,0,-e,0],[0,1,0,0],[e,0,r,0],[0,0,0,1]]))}rotateZ(t){const r=Math.cos(t),e=Math.sin(t);return this.multiply(new s([[r,-e,0,0],[e,r,0,0],[0,0,1,0],[0,0,0,1]]))}multiply(t){const r=this.transformVector(t.column(1)),e=this.transformVector(t.column(2)),n=this.transformVector(t.column(3)),o=this.transformVector(t.column(4));return new s([[r.x,e.x,n.x,o.x],[r.y,e.y,n.y,o.y],[r.z,e.z,n.z,o.z],[r.w,e.w,n.w,o.w]])}inverse(){const t=n.gluInvertMatrix(this.toFloat32Array());if(null===t)throw new Error("Matrix is non-invertible!");return s.fromFloat32Array(t)}map(t){return new s(this.values.map(r=>r.map(t)))}multiplyByConstant(t){return this.map(r=>r*t)}static perspectiveProjection(t){const{near:r,far:e,left:n,right:o,top:i,bottom:a}=t,c=o-n,l=i-a,u=e-r,h=2*r;return new s([[h/c,0,(o+n)/c,0],[0,h/l,(i+a)/l,0],[0,0,-(e+r)/u,-2*e*r/u],[0,0,-1,0]])}transformVector(t){const r=this.valueAt;return new i(r(1,1)*t.x+r(1,2)*t.y+r(1,3)*t.z+r(1,4)*t.w,r(2,1)*t.x+r(2,2)*t.y+r(2,3)*t.z+r(2,4)*t.w,r(3,1)*t.x+r(3,2)*t.y+r(3,3)*t.z+r(3,4)*t.w,r(4,1)*t.x+r(4,2)*t.y+r(4,3)*t.z+r(4,4)*t.w)}column(t){const r=this.valueAt;return new i(r(1,t),r(2,t),r(3,t),r(4,t))}}r.Matrix3D=s},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e(2),o=e(4),i=e(5),s=e(0),a=e(6),c=e(7);class l{constructor(t){this.z=t,this.orbitTheta=Math.random(),this.orbitThetaVelocity=.01*Math.random(),this.distanceFromCenter=Math.random(),this.scale=.5,this.shipTheta=Math.random(),this.shipThetaVelocity=.05*Math.random()}update(){this.orbitTheta+=this.orbitThetaVelocity,this.shipTheta+=this.shipThetaVelocity}}window.addEventListener("DOMContentLoaded",()=>{const t=document.createElement("canvas");document.body.appendChild(t),t.width=800,t.height=800,t.style.border="1px solid black";const r=t.getContext("webgl");if(!r)throw new Error("webgl is not supported on this browser!");const e=new class extends o.GlProgram{constructor(t){super(t,a,c),this.transform=new o.GlUniformMatrix3D(this,"u_transform"),this.positionAttributeLocation=o.getAttribLocation(t,this.program,"a_position")}}(r),u=new i.Points3DRenderer(e,function(){const t=n.Points3D.fromArray([-.5,0,0,0,.75,0,0,.15,0]);return t.concat(t.mirrorHorizontally())}()),h=new i.Points3DRenderer(e,function(t=-1,r=20){const e=[];let o=-1,i=-1,s=1/r;for(let n=0;n<=r;n++)e.push(o,t,i),e.push(o,t,i+2),o+=2*s;o=-1;for(let n=0;n<=r;n++)e.push(o,t,i),e.push(o+2,t,i),i+=2*s;return n.Points3D.fromArray(e)}());let f=null;const m=s.Matrix3D.perspectiveProjection({top:1,bottom:-1,right:1,left:-1,near:1,far:3}),p=[];let d=null,w=null;for(let t=0;t<30;t++)p.push(new l(t/30*2-1));t.onclick=(r=>{const e=r.offsetX/t.width*2-1,n=-1*(r.offsetY/t.height*2-1);d=[e,n]}),console.log("Initialization successful!");let g=0;const y=()=>{const t=(new s.Matrix3D).rotateY(g).translate(0,0,2.25),o=t.inverse(),a=m.multiply(o);if(d&&w!==d){const r=a.inverse(),o=new s.Vector3D(d[0],d[1],-1),c=r.transformVector(o).perspectiveDivide(),l=t.transformVector(new s.Vector3D(0,0,0)),u=c.minus(l);f=new i.Points3DRenderer(e,function(t,r,e=10,o=5){let i=t;const s=r.normalize().times(o/e),a=[];for(let t=0;t<e;t++)a.push(i.x,i.y,i.z),i=i.plus(s),a.push(i.x,i.y,i.z);return n.Points3D.fromArray(a)}(l,u)),w=d}g+=.001,r.viewport(0,0,r.canvas.width,r.canvas.height),r.enable(r.DEPTH_TEST),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),e.activate(),f&&(f.setupForDrawing(),e.transform.set(a),f.draw(r.LINES)),h.setupForDrawing(),e.transform.set(a),h.draw(r.LINES),u.setupForDrawing(),p.forEach(t=>{const r=(new s.Matrix3D).rotateZ(t.orbitTheta).translate(t.distanceFromCenter,0,t.z).scale(t.scale).rotateY(t.shipTheta);e.transform.set(a.multiply(r)),u.draw(),t.update()}),window.requestAnimationFrame(y)};y()})},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=e(0);class o{constructor(t){this.array=t}toFloat32Array(){const{array:t}=this,r=new Float32Array(3*t.length);let e=0;for(let n=0;n<r.length;n+=3)r[n]=t[e].x,r[n+1]=t[e].y,r[n+2]=t[e].z,e+=1;return r}concat(t){const r=this.array.concat(t.array);return new o(r)}mirrorHorizontally(){return new o(this.array.map(t=>new n.Vector3D(-t.x,t.y,t.z)))}get length(){return this.array.length}static fromArray(t){const r=t.length/3,e=new Array(r);let i=0;for(let o=0;o<r;o++){const r=t[i],s=t[i+1],a=t[i+2];e[o]=new n.Vector3D(r,s,a),i+=3}return new o(e)}}r.Points3D=o},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.gluInvertMatrix=function(t){const r=new Float32Array(16);r[0]=t[5]*t[10]*t[15]-t[5]*t[11]*t[14]-t[9]*t[6]*t[15]+t[9]*t[7]*t[14]+t[13]*t[6]*t[11]-t[13]*t[7]*t[10],r[4]=-t[4]*t[10]*t[15]+t[4]*t[11]*t[14]+t[8]*t[6]*t[15]-t[8]*t[7]*t[14]-t[12]*t[6]*t[11]+t[12]*t[7]*t[10],r[8]=t[4]*t[9]*t[15]-t[4]*t[11]*t[13]-t[8]*t[5]*t[15]+t[8]*t[7]*t[13]+t[12]*t[5]*t[11]-t[12]*t[7]*t[9],r[12]=-t[4]*t[9]*t[14]+t[4]*t[10]*t[13]+t[8]*t[5]*t[14]-t[8]*t[6]*t[13]-t[12]*t[5]*t[10]+t[12]*t[6]*t[9],r[1]=-t[1]*t[10]*t[15]+t[1]*t[11]*t[14]+t[9]*t[2]*t[15]-t[9]*t[3]*t[14]-t[13]*t[2]*t[11]+t[13]*t[3]*t[10],r[5]=t[0]*t[10]*t[15]-t[0]*t[11]*t[14]-t[8]*t[2]*t[15]+t[8]*t[3]*t[14]+t[12]*t[2]*t[11]-t[12]*t[3]*t[10],r[9]=-t[0]*t[9]*t[15]+t[0]*t[11]*t[13]+t[8]*t[1]*t[15]-t[8]*t[3]*t[13]-t[12]*t[1]*t[11]+t[12]*t[3]*t[9],r[13]=t[0]*t[9]*t[14]-t[0]*t[10]*t[13]-t[8]*t[1]*t[14]+t[8]*t[2]*t[13]+t[12]*t[1]*t[10]-t[12]*t[2]*t[9],r[2]=t[1]*t[6]*t[15]-t[1]*t[7]*t[14]-t[5]*t[2]*t[15]+t[5]*t[3]*t[14]+t[13]*t[2]*t[7]-t[13]*t[3]*t[6],r[6]=-t[0]*t[6]*t[15]+t[0]*t[7]*t[14]+t[4]*t[2]*t[15]-t[4]*t[3]*t[14]-t[12]*t[2]*t[7]+t[12]*t[3]*t[6],r[10]=t[0]*t[5]*t[15]-t[0]*t[7]*t[13]-t[4]*t[1]*t[15]+t[4]*t[3]*t[13]+t[12]*t[1]*t[7]-t[12]*t[3]*t[5],r[14]=-t[0]*t[5]*t[14]+t[0]*t[6]*t[13]+t[4]*t[1]*t[14]-t[4]*t[2]*t[13]-t[12]*t[1]*t[6]+t[12]*t[2]*t[5],r[3]=-t[1]*t[6]*t[11]+t[1]*t[7]*t[10]+t[5]*t[2]*t[11]-t[5]*t[3]*t[10]-t[9]*t[2]*t[7]+t[9]*t[3]*t[6],r[7]=t[0]*t[6]*t[11]-t[0]*t[7]*t[10]-t[4]*t[2]*t[11]+t[4]*t[3]*t[10]+t[8]*t[2]*t[7]-t[8]*t[3]*t[6],r[11]=-t[0]*t[5]*t[11]+t[0]*t[7]*t[9]+t[4]*t[1]*t[11]-t[4]*t[3]*t[9]-t[8]*t[1]*t[7]+t[8]*t[3]*t[5],r[15]=t[0]*t[5]*t[10]-t[0]*t[6]*t[9]-t[4]*t[1]*t[10]+t[4]*t[2]*t[9]+t[8]*t[1]*t[6]-t[8]*t[2]*t[5];let e=t[0]*r[0]+t[1]*r[4]+t[2]*r[8]+t[3]*r[12];if(0==e)return null;e=1/e;for(let t=0;t<16;t++)r[t]*=e;return r}},function(t,r,e){"use strict";function n(t,r,e){const n=t.createShader(r);if(!n)throw new Error("gl.createShader() failed!");if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS)){const r="Compiling shader failed: "+t.getShaderInfoLog(n);throw t.deleteShader(n),new Error(r)}return n}Object.defineProperty(r,"__esModule",{value:!0}),r.getAttribLocation=function(t,r,e){const n=t.getAttribLocation(r,e);if(-1===n)throw new Error(`Unable to find attribute '${e}'!`);return n};r.GlProgram=class{constructor(t,r,e){this.gl=t;const o=n(t,WebGLRenderingContext.VERTEX_SHADER,r),i=n(t,WebGLRenderingContext.FRAGMENT_SHADER,e);this.program=function(t,r,e){const n=t.createProgram();if(!n)throw new Error("gl.createProgram() failed!");if(t.attachShader(n,r),t.attachShader(n,e),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS)){const r="Linking program failed: "+t.getProgramInfoLog(n);throw t.deleteProgram(n),new Error(r)}return n}(t,o,i)}activate(){this.gl.useProgram(this.program)}};class o{constructor(t,r){this.program=t,this.location=function(t,r,e){const n=t.getUniformLocation(r,e);if(null===n)throw new Error(`Unable to find uniform '${e}'!`);return n}(t.gl,t.program,r)}}r.GlUniformVector=class extends o{set(t){this.program.gl.uniform4fv(this.location,t)}};r.GlUniformFloat=class extends o{set(t){this.program.gl.uniform1f(this.location,t)}};r.GlUniformMatrix3D=class extends o{set(t){this.program.gl.uniformMatrix4fv(this.location,!1,t.toFloat32Array())}}},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.Points3DRenderer=class{constructor(t,r){this.program=t,this.points=r;const{gl:e}=t,n=e.createBuffer();if(null===n)throw new Error("gl.createBuffer() failed!");e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,r.toFloat32Array(),e.STATIC_DRAW),this.buffer=n}setupForDrawing(){const{gl:t,positionAttributeLocation:r}=this.program;t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,this.buffer);const e=t.FLOAT;t.vertexAttribPointer(r,3,e,!1,0,0)}draw(t=WebGLRenderingContext.TRIANGLES){const{gl:r}=this.program,e=this.points.length;r.drawArrays(t,0,e)}}},function(t,r){t.exports="attribute vec4 a_position;\n\nuniform mat4 u_transform;\n\nvoid main() {\n  gl_Position = u_transform * a_position;\n}\n"},function(t,r){t.exports="precision mediump float;\n\nvoid main() {\n  // This essentially visualizes the z-buffer. Taken from:\n  //\n  //   https://learnopengl.com/Advanced-OpenGL/Depth-testing\n  gl_FragColor = vec4(vec3(gl_FragCoord.z), 1.0);\n}\n"}]);
//# sourceMappingURL=app.bundle.js.map